CREATE TABLE musteri (
                    clientNo VARCHAR(9),
                    fName VARCHAR(15),
                    lName VARCHAR(15),
                    gender VARCHAR(1),
                    mCity VARCHAR(10),
                    street VARCHAR (11),
                    yearsPast NUMBER(2) ,
                    billQuantity NUMBER(3),
                    lastDate DATE,
                    status VARCHAR(8),
                    sifre VARCHAR(99));
CREATE TABLE city(
                    cityName VARCHAR(10) UNIQUE,
                    cityCode VARCHAR(2) PRIMARY KEY,
                    numberOfStreets DECIMAL, /*O þehirde kaç tane mahalle/semt olduðunu gösteren sayý*/
                    numberOfClients DECIMAL, /*O þehirde kaç tane müþteri bulunduðunu gösteren sayý*/
                    numberOfActiveClients DECIMAL, /*O þehirde kaç tane aktif müþteri bulunduðunu gösteren sayý*/
                    numberOfPassiveClients DECIMAL /*O þehirde kaç tane pasif müþteri bulunduðunu gösteren sayý*/
                    );

CREATE TABLE street(
                    streetName VARCHAR(20),
                    streetCode VARCHAR(2),
                    cityOfThisStreet VARCHAR(10),
                    stNumberOfClients DECIMAL, /*O semt/mahallede kaç tane müþteri bulunduðunu gösteren sayý*/
                    stNumberOfActiveClients DECIMAL, /*O semt/mahallede kaç tane aktif müþteri bulunduðunu gösteren sayý*/
                    stNumberOfPassiveClients DECIMAL, /*O semt/mahallede kaç tane pasif müþteri bulunduðunu gösteren sayý*/
                    eklenmeSirasi NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
                    FOREIGN KEY (cityOfThisStreet) REFERENCES city (cityName)
                    );
                    
CREATE TABLE personel(
                    personelNo VARCHAR(9),
                    pFName VARCHAR(15),
                    pLName VARCHAR(15),
                    pGender VARCHAR(1),
                    pCity VARCHAR(10),
                    pSifre VARCHAR(99));

/*Müþteriler*/
INSERT INTO musteri VALUES('060100001', 'Hamit', 'Yüksel', 'M', 'Ankara', 'Çankaya', 11 ,100, TO_DATE('01/12/2020', 'DD/MM/YYYY'), 'ACTIVE', 'HY123');
INSERT INTO musteri VALUES('060100002', 'Özgür', 'Kýsýr', 'M', 'Ankara', 'Çankaya', 3 , NULL, NULL , 'ACTIVE','OK123');
INSERT INTO musteri VALUES('380200001', 'Öykü', 'Yener', 'F', 'Kayseri', 'Melikgazi', 5, 55, TO_DATE('01/12/2020', 'DD/MM/YYYY'), 'ACTIVE','OY123');
INSERT INTO musteri VALUES('380200002', 'Necmiye', 'Yýlmaz', 'F', 'Kayseri', 'Melikgazi', 1 ,150, TO_DATE('01/12/2020', 'DD/MM/YYYY'), 'ACTIVE','NY123');
INSERT INTO musteri VALUES('780100001', 'Hüseyin', 'Mert', 'M', 'Karabük', 'Merkez', 4 ,63, TO_DATE('01/12/2020', 'DD/MM/YYYY'), 'ACTIVE','HM123');
INSERT INTO musteri VALUES('780100002', 'Sadiye', 'Kök', 'F', 'Karabük', 'Merkez', 20 ,NULL, NULL,'ACTIVE','SK123');
INSERT INTO musteri VALUES('420200001', 'Emin', 'Ateþ', 'M', 'Konya', 'Ereðli', 30 ,NULL, NULL, 'ACTIVE','EA123');
INSERT INTO musteri VALUES('420200002', 'Zehra', 'Mavi', 'F', 'Konya', 'Ereðli', 15 ,90, TO_DATE('01/12/2020', 'DD/MM/YYYY'), 'ACTIVE','ZM123');
INSERT INTO musteri VALUES('670300001', 'Nazile', 'Yeþil', 'F', 'Zonguldak', 'Kilimli', 25 ,63, TO_DATE('01/12/2020', 'DD/MM/YYYY'), 'ACTIVE','NY123');
INSERT INTO musteri VALUES('670300002', 'Emre', 'Kömür', 'M', 'Zonguldak', 'Kilimli', 9 ,38, TO_DATE('01/12/2020', 'DD/MM/YYYY'), 'ACTIVE','EK123');
/*MÜÞTERÝLER SONU*/

/*ÞEHÝRLER*/
INSERT INTO city VALUES('Ankara','06', NULL, NULL, NULL, NULL);
INSERT INTO city VALUES('Kayseri','38', NULL, NULL, NULL, NULL);
INSERT INTO city VALUES('Karabük','78', NULL, NULL, NULL, NULL);
INSERT INTO city VALUES('Konya','42', NULL, NULL, NULL, NULL);
INSERT INTO city VALUES('Zonguldak','67', NULL, NULL, NULL, NULL);
/*ÞEHÝRLER SONU*/

/*SEMTLER*/
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Çankaya','01','Ankara', NULL, NULL, NULL);
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Yenimahalle','02','Ankara', NULL, NULL, NULL);
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Altýndað','03','Ankara', NULL, NULL, NULL);
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Keçiören','04','Ankara', NULL, NULL, NULL);
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Kocasinan','01','Kayseri', NULL, NULL, NULL);
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Melikgazi','02','Kayseri', NULL, NULL, NULL);
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Felahiye','03','Kayseri', NULL, NULL, NULL);
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Merkez','01','Karabük', NULL, NULL, NULL);
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Safranbolu','02','Karabük', NULL, NULL, NULL);
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Selçuklu','01','Konya', NULL, NULL, NULL);
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Ereðli','02','Konya', NULL, NULL, NULL);
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Zonguldak','01','Zonguldak', NULL, NULL, NULL);
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Karadeniz Ereðli','02','Zonguldak', NULL, NULL, NULL);
INSERT INTO street (streetName, streetCode, cityOfThisStreet, stNumberOfClients, stNumberOfActiveClients, stNumberOfPassiveClients) VALUES('Kilimli','03','Zonguldak', NULL, NULL, NULL);
/*SEMTLER SONU*/

/*Çalýþanlar*/
INSERT INTO personel VALUES('0601','Ali','Akman', 'M', 'Ankara', 'PerA06');
INSERT INTO personel VALUES('3801','Ayþe','Varil', 'F', 'Kayseri', 'PerA38');
INSERT INTO personel VALUES('4201','Recep','Taþ', 'M', 'Konya', 'PerR42');
INSERT INTO personel VALUES('6701','Þükran','Acar', 'F', 'Zonguldak', 'PerS67');
INSERT INTO personel VALUES('7801','Nilgün','Biricik', 'F', 'Karabük', 'PerN78');
/*Çalýþanlar Sonu*/

UPDATE city c SET numberOfClients = (SELECT COUNT(clientNo) FROM musteri WHERE c.cityName = mCity);
UPDATE city c SET numberOfActiveClients = (SELECT COUNT(clientNo) FROM musteri WHERE c.cityName = mCity AND status = 'ACTIVE');
UPDATE city c SET numberOfPassiveClients = (SELECT COUNT(clientNo) FROM musteri WHERE c.cityName = mCity AND status = 'PASSIVE');
UPDATE city c SET numberOfStreets = (SELECT COUNT(streetName) FROM street WHERE c.cityName = cityOfThisStreet);

UPDATE street s SET stNumberOfClients = (SELECT COUNT(clientNo) FROM musteri WHERE s.streetName = street);
UPDATE street s SET stNumberOfActiveClients = (SELECT COUNT(clientNo) FROM musteri WHERE s.streetName = street AND status = 'ACTIVE');
UPDATE street s SET stNumberOfPassiveClients = (SELECT COUNT(clientNo) FROM musteri WHERE s.streetName = street AND status = 'PASSIVE');

select * from musteri ORDER BY clientNo;
select * from city ORDER BY cityCode;
select * from street;
select * from personel;